<?php
///////////////////////////////////////////////////////////////////////////

class ZTVDaemonController
{
	///////////////////////////////////////////////////////////////////////////

	const ARESCAM_CTL = '/bin/arescam-ctl';

	///////////////////////////////////////////////////////////////////////////

	private static function run( $op, $args = array() )
	{
		$cmd = dirname(__FILE__) . self::ARESCAM_CTL . ' ' . $op;
		foreach($args as $name => $value) {
			$value = escapeshellarg($value);
			$cmd .= " $name $value";
		}
		$out = system($cmd, $rc);
		hd_print("DAEMON: cmd '$cmd'; rc $rc; output '$out'");
		return (object)array('output' => $out, 'rc' => $rc);
	}

	///////////////////////////////////////////////////////////////////////////

	public static function status()
	{
		return self::run('status');
	}

	///////////////////////////////////////////////////////////////////////////

	public static function start( $args = array() )
	{
		return self::run('start', $args);
	}

	///////////////////////////////////////////////////////////////////////////

	public static function stop()
	{
		return self::run('stop');
	}

	///////////////////////////////////////////////////////////////////////////

	public static function restart( $args = array() )
	{
		return self::run('restart', $args);
	}

	///////////////////////////////////////////////////////////////////////////

	public static function login( $args = array() )
	{
		return self::run('login', $args);
	}

	///////////////////////////////////////////////////////////////////////////

	public static function register( $args = array() )
	{
		return self::run('register', $args);
	}

	///////////////////////////////////////////////////////////////////////////

	public static function deregister()
	{
		return self::run('deregister');
	}
}

///////////////////////////////////////////////////////////////////////////
?>